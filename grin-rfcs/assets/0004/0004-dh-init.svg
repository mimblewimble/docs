<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="498px" preserveAspectRatio="none" style="width:608px;height:498px;" version="1.1" viewBox="0 0 608 498" width="608px" zoomAndPan="magnify"><defs><filter height="300%" id="f14n62ugonf14k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="276" x="161.75" y="23.0059">Wallet JSON-RPC API ECDH Initialization</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="29" x2="29" y1="117.5999" y2="410.7999"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="215.5" x2="215.5" y1="117.5999" y2="410.7999"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="402.5" x2="402.5" y1="117.5999" y2="410.7999"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="533.5" x2="533.5" y1="117.5999" y2="410.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="8" y="113.8059">Client</text><ellipse cx="29" cy="43.7999" fill="#FEFECE" filter="url(#f14n62ugonf14k)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M29,51.7999 L29,78.7999 M16,59.7999 L42,59.7999 M29,78.7999 L16,93.7999 M29,78.7999 L42,93.7999 " fill="none" filter="url(#f14n62ugonf14k)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="36" x="8" y="422.8059">Client</text><ellipse cx="29" cy="436.5999" fill="#FEFECE" filter="url(#f14n62ugonf14k)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M29,444.5999 L29,471.5999 M16,452.5999 L42,452.5999 M29,471.5999 L16,486.5999 M29,471.5999 L42,486.5999 " fill="none" filter="url(#f14n62ugonf14k)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f14n62ugonf14k)" height="30.7999" style="stroke: #A80036; stroke-width: 1.5;" width="111" x="158.5" y="81.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="165.5" y="101.8059">JSON-RPC API</text><rect fill="#FEFECE" filter="url(#f14n62ugonf14k)" height="30.7999" style="stroke: #A80036; stroke-width: 1.5;" width="111" x="158.5" y="409.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="97" x="165.5" y="429.8059">JSON-RPC API</text><rect fill="#FEFECE" filter="url(#f14n62ugonf14k)" height="30.7999" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="340.5" y="81.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="347.5" y="101.8059">Internal Rust API</text><rect fill="#FEFECE" filter="url(#f14n62ugonf14k)" height="30.7999" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="340.5" y="409.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="107" x="347.5" y="429.8059">Internal Rust API</text><rect fill="#FEFECE" filter="url(#f14n62ugonf14k)" height="30.7999" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="475.5" y="81.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="482.5" y="101.8059">Wallet Backend</text><rect fill="#FEFECE" filter="url(#f14n62ugonf14k)" height="30.7999" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="475.5" y="409.7999"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="482.5" y="429.8059">Wallet Backend</text><rect fill="#EEEEEE" filter="url(#f14n62ugonf14k)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="593.5" x="3" y="148.3999"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="596.5" y1="148.3999" y2="148.3999"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="596.5" y1="151.3999" y2="151.3999"/><rect fill="#EEEEEE" filter="url(#f14n62ugonf14k)" height="23.6" style="stroke: #000000; stroke-width: 2.0;" width="207" x="196.25" y="137.5999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="202.25" y="153.6769">Initialization (ECDH/secp256k1)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="29" x2="71" y1="192.7999" y2="192.7999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="71" x2="71" y1="192.7999" y2="205.7999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30" x2="71" y1="205.7999" y2="205.7999"/><polygon fill="#A80036" points="40,201.7999,30,205.7999,40,209.7999,36,205.7999" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="36" y="187.2769">Calc Pub ECDH Key (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="164" y="187.2769">cP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="180" y="187.2769">)</text><polygon fill="#A80036" points="204,231.3999,214,235.3999,204,239.3999,208,235.3999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="29" x2="210" y1="235.3999" y2="235.3999"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="36" y="229.8769">init_api_secure (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="131" y="229.8769">cP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="147" y="229.8769">)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="216" x2="258" y1="264.9999" y2="264.9999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="258" x2="258" y1="264.9999" y2="277.9999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="217" x2="258" y1="277.9999" y2="277.9999"/><polygon fill="#A80036" points="227,273.9999,217,277.9999,227,281.9999,223,277.9999" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="223" y="259.4769">Calc Pub ECDH Key (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="351" y="259.4769">sP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="367" y="259.4769">)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="216" x2="258" y1="307.5999" y2="307.5999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="258" x2="258" y1="307.5999" y2="320.5999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="217" x2="258" y1="320.5999" y2="320.5999"/><polygon fill="#A80036" points="227,316.5999,217,320.5999,227,324.5999,223,320.5999" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="223" y="302.0769">Calc + store shared secret (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="385" y="302.0769">s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="392" y="302.0769">)</text><polygon fill="#A80036" points="40,346.1999,30,350.1999,40,354.1999,36,350.1999" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="34" x2="215" y1="350.1999" y2="350.1999"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="46" y="344.6769">sP</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="29" x2="71" y1="379.7999" y2="379.7999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="71" x2="71" y1="379.7999" y2="392.7999"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="30" x2="71" y1="392.7999" y2="392.7999"/><polygon fill="#A80036" points="40,388.7999,30,392.7999,40,396.7999,36,392.7999" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="36" y="374.2769">Calc + store shared secret (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="7" x="198" y="374.2769">s</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="205" y="374.2769">)</text><!--
@startuml
actor "Client" as client
participant "JSON-RPC API" as jsonrpc
participant "Internal Rust API" as rustapi
participant "Wallet Backend" as backend

title Wallet JSON-RPC API ECDH Initialization

== Initialization (ECDH/secp256k1)==
client -> client: Calc Pub ECDH Key (**cP**)
client -> jsonrpc: init_api_secure (**cP**)
jsonrpc -> jsonrpc: Calc Pub ECDH Key (**sP**)
jsonrpc -> jsonrpc: Calc + store shared secret (**s**)
jsonrpc -> client: **sP**
client -> client: Calc + store shared secret (**s**)
@enduml

PlantUML version 1.2019.06(Fri May 24 18:10:25 IST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 12.0.1+12
Operating System: Linux
OS Version: 5.1.11-arch1-1-ARCH
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>